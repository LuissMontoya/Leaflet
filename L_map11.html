<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      #map {
        width: 100%;
        height: 580px;
        box-shadow: 5px 5px 5px #888;
      }
    </style>
    <script src=" https://unpkg.com/leaflet@1.6.0/dist/leaflet.js "></script>
    <link
      rel="stylesheet"
      href=" https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    />
    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>

    <title>L_map 11</title>
  </head>

  <body>
    <div id="map"></div>

    <script>
      var osm = L.tileLayer(
        "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
        {
          attribution:
            '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a>' +
            "contributors",
          maxZoom: 18,
        }
      );
      var paises = new L.tileLayer.wms(
        "http://localhost:8080/geoserver/earth/wms",
        {
          layers: "paises",
          format: "image/png",
          transparent: true,
          attribution: "NaturalEarth",
        }
      );
      var ciudades = new L.tileLayer.wms(
        "http://localhost:8080/geoserver/earth/wms",
        {
          layers: "ciudades",
          format: "image/png",
          transparent: true,
          attribution: "NaturalEarth",
        }
      );

      var map = L.map("map", {
        center: [41.66, -4.72],
        zoom: 2,
      });

      var owsrootUrl = "http://localhost:8080/geoserver/ows";

      var defaultParameters = {
        service: "WFS",
        version: "1.0.0",
        request: "GetFeature",
        typeName: "earth:paises",
        outputFormat: "application/json",
      };
      var parameters = L.Util.extend(defaultParameters);
      var URL = owsrootUrl + L.Util.getParamString(parameters);

      $.ajax({
        url: URL,
        success: function (data) {
          //creamos una nueva capa geojson
          var geojson = new L.geoJson(data, {
            //Aplicamos un estilo
            style: { color: "#2ECCFA", weight: 2 },
            //vinculamos un popup mostrando el nombre del pa√≠s
            onEachFeature: function (feature, layer) {
              layer.bindPopup("Has hecho click en " + feature.properties.name);
            },
          }).addTo(map);
        },
      });

      L.control.scale().addTo(map);
    </script>
  </body>
</html>
